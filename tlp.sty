\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tlp}[2020/10/01 v1.0 Traffic Light Protocol (TLP) stamps]
% Implements https://www.first.org/tlp/ stamps

\RequirePackage{xcolor}
\RequirePackage{xstring}

\def\Tlp@Level{WHITE}
\newcommand\tlp[1]{\def\Tlp@Level{#1}}
\DeclareOption{TLP:RED}{\def\Tlp@Level{RED}}
\DeclareOption{TLP:GREEN}{\def\Tlp@Level{GREEN}}
\DeclareOption{TLP:AMBER}{\def\Tlp@Level{AMBER}}
\DeclareOption{TLP:WHITE}{\def\Tlp@Level{WHITE}}

\ProcessOptions\relax

\def\Tlp@Font{\sffamily\bfseries\large}
\newcommand\tlpfont[1]{\def\Tlp@Font{#1}}

\definecolor{TlpRed}{RGB}{255,0,51}
\definecolor{TlpAmber}{RGB}{255,192,0}
\definecolor{TlpGreen}{RGB}{51,255,0}
\definecolor{TlpWhite}{RGB}{255,255,255}

\newcommand\Tlp@Stamp[2]{%
    {%
        \Tlp@Font % Set font
        \setlength{\fboxsep}{\f@size pt} % Get current size font
        \setlength{\fboxsep}{0.5\fboxsep}% Keep half size font
        \colorbox{black}{\color{#1}#2}%
    }%
}

\newcommand\TLP[1]{%
    \IfStrEqCase*{#1}{%
        {RED}{\Tlp@Stamp{TlpRed}{TLP:RED}}%
        {AMBER}{\Tlp@Stamp{TlpAmber}{TLP:AMBER}}%
        {GREEN}{\Tlp@Stamp{TlpGreen}{TLP:GREEN}}%
        {WHITE}{\Tlp@Stamp{TlpWhite}{TLP:WHITE}}%
    }[\PackageWarning{tlp}{Only TLP:RED, TLP:AMBER, TLP:GREEN and TLP:WHITE are defined, received '#1'}]%
}


\newcommand\tlpstamp{\TLP{\Tlp@Level}}